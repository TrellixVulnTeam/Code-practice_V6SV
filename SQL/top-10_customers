# https://www.codewars.com/kata/580d08b5c049aef8f900007c/sql
Top 10 customers by total payments amount

SELECT 
       c.customer_id, 
       c.email, 
       COUNT(p.payment_id) AS payments_count,
       CAST(SUM(p.amount) AS float) AS total_amount
FROM customer c, payment p
WHERE c.customer_id = p.customer_id
GROUP BY c.customer_id
ORDER BY total_amount DESC
LIMIT 10
