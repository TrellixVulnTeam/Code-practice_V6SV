-- https://www.codewars.com/kata/582cba7d3be8ce3a8300007c
-- SQL Bug Fixing: Fix the QUERY - Totaling

SELECT 
  s.transaction_date::date as day,
  d.name::text AS department,
  COUNT(s.id)::int AS sale_count
  FROM department d
    JOIN sale s 
    on d.id = s.department_id
  group by day, d.name
  ORDER BY day
